# 📘 Next.js 16+ 완전 정복 가이드 (왕초보용 상세 설명서)

안녕하세요! 👋
이 문서는 **"Next.js가 뭔가요? 먹는 건가요?"** 수준의 초보자도 이해할 수 있도록 아주 상세하게 작성된 **Next.js 16 (App Router)** 쇼핑몰 프로젝트 설명서입니다.

단순히 "이 코드는 이겁니다"가 아니라, **"왜(Why) 이렇게 짰는지"**, **"실무에서는 어떻게 하는지"**에 초점을 맞췄습니다. 천천히 읽어보시면 Next.js의 큰 그림이 그려지실 거예요.

---

## 📚 목차

1.  **🚀 시작하기 (설치부터 실행까지)**
2.  **🏗️ 폴더 구조 해부학 (여긴 어디? 나는 누구?)**
    *   `src/app` 폴더의 비밀 (라우팅)
    *   `(괄호)` 폴더는 왜 쓸까?
    *   `layout.tsx` vs `page.tsx`
3.  **🧠 Next.js 핵심 개념 (이것만 알면 고수)**
    *   서버 컴포넌트 vs 클라이언트 컴포넌트
    *   서버 액션 (Server Actions)
    *   동적 라우팅 (`[slug]`)
4.  **🛠️ 사용된 기술들 (Why?)**
    *   Prisma (데이터베이스)
    *   Tailwind CSS (스타일링)
    *   Zustand (장바구니)
5.  **🌟 실전 코드 뜯어보기**
    *   상품 페이지가 그려지는 과정
    *   장바구니 담기 버튼의 원리

---

## 🚀 1. 시작하기 (설치부터 실행까지)

일단 내 컴퓨터에서 돌아가는 걸 봐야겠죠? 터미널(검은 화면)을 열고 따라 하세요.

```bash
# 1. 의존성 설치 (필요한 라이브러리들을 다운로드합니다)
npm install

# 2. 데이터베이스 설정 (prisma/schema.prisma 파일을 보고 DB 테이블을 만듭니다)
npx prisma migrate dev --name init

# 3. 더미 데이터 넣기 (빈 화면은 심심하니까 가짜 상품 데이터를 채워넣습니다)
node prisma/seed.js

# 4. 개발 서버 실행 (이제 http://localhost:3000 으로 접속 가능!)
npm run dev
```

---

## 🏗️ 2. 폴더 구조 해부학 (여긴 어디? 나는 누구?)

Next.js의 **App Router** 방식에서 가장 중요한 규칙은 **"폴더 경로가 곧 웹사이트 주소(URL)"**라는 것입니다.

### 📂 전체 구조 요약

```text
src/
├── actions/        # [서버 액션] 백엔드 API 대신 쓰는 함수들 (DB 저장, 조회 등)
├── app/            # [라우팅] 웹사이트의 모든 페이지가 여기 있습니다.
│   ├── (shop)/     # [그룹] 일반 쇼핑몰 화면 (URL에 안 보임)
│   ├── (admin)/    # [그룹] 관리자 전용 화면 (URL에 안 보임)
│   ├── (auth)/     # [그룹] 로그인/회원가입 화면 (URL에 안 보임)
│   ├── layout.tsx  # [최상위 레이아웃] 모든 페이지를 감싸는 껍데기 (폰트, 테마 설정)
│   └── globals.css # [스타일] 전체 공통 디자인
├── components/     # [레고 블록] 재사용 가능한 버튼, 입력창, 카드 등
├── lib/            # [도구함] DB 연결, 유틸리티 함수, 상태 관리(store)
└── prisma/         # [DB 설계도] 데이터베이스 모델 정의 (schema.prisma)
```

### 🤔 Q. `(shop)`, `(auth)` 처럼 괄호 `()`는 왜 쓰나요?

**A. 레이아웃(디자인 껍데기)을 다르게 주기 위해서입니다.**

Next.js에서 폴더명에 괄호를 치면 **URL 주소에는 포함되지 않는 '경로 그룹(Route Group)'**이 됩니다.

*   **상황:**
    *   쇼핑몰 페이지들(`(shop)`)에는 항상 **헤더(메뉴)**와 **푸터(바닥글)**가 있어야 합니다.
    *   로그인 페이지(`(auth)`)는 깔끔하게 중앙에 로그인 창만 있어야 합니다. 헤더/푸터가 있으면 산만하죠.
    *   관리자 페이지(`(admin)`)는 왼쪽에 **사이드바 메뉴**가 있어야 합니다.
*   **해결:**
    *   `(shop)/layout.tsx`: 헤더+푸터 적용
    *   `(auth)/layout.tsx`: 헤더+푸터 없음 (깔끔)
    *   `(admin)/layout.tsx`: 사이드바 적용

이렇게 그룹을 나누면 **URL은 깔끔하게 유지하면서(`site.com/login`), 디자인은 그룹별로 다르게** 가져갈 수 있습니다.

### 📄 파일들의 역할 (규칙)

Next.js는 파일 이름에 특별한 의미를 부여합니다. 약속입니다.

| 파일명 | 역할 | 비유 |
| :--- | :--- | :--- |
| **`page.tsx`** | **실제 화면** | 액자 속의 그림 |
| **`layout.tsx`** | **공통 레이아웃** | 그림을 감싸는 액자 틀 (헤더, 푸터 등) |
| **`loading.tsx`** | **로딩 화면** | 데이터 가져올 때 잠깐 보여줄 모래시계 ⏳ |
| **`not-found.tsx`** | **404 페이지** | "주소를 못 찾겠어요" 안내판 |
| **`error.tsx`** | **에러 페이지** | "어라? 고장이 났네요" 안내판 |
| **`route.ts`** | **API 엔드포인트** | HTML이 아니라 JSON 데이터만 줄 때 (옛날 백엔드 방식) |

---

## 🧠 3. Next.js 핵심 개념 (이것만 알면 고수)

### 🔥 3-1. 서버 컴포넌트 vs 클라이언트 컴포넌트

이 프로젝트를 보면서 가장 많이 보게 될 개념입니다.

#### 🖥️ 서버 컴포넌트 (Server Component)
*   **기본값:** 별말 없으면 모든 컴포넌트는 서버 컴포넌트입니다.
*   **특징:** 서버에서 HTML을 다 만들어서 브라우저로 보냅니다.
*   **장점:**
    *   **빠르다:** 사용자의 컴퓨터가 느려도 상관없음.
    *   **DB 접근 가능:** `db.product.findMany()` 처럼 컴포넌트 안에서 바로 DB를 뒤질 수 있습니다. (보안상 안전)
    *   **SEO(검색엔진) 최적화:** 구글 로봇이 내용을 아주 잘 읽어갑니다.
*   **단점:** `onClick`(클릭 이벤트), `useState`(상태 관리), `useEffect` 같은 **상호작용 기능을 못 씁니다.**

#### 🖱️ 클라이언트 컴포넌트 (Client Component)
*   **선언:** 파일 맨 위에 `"use client"`라고 적어야 합니다.
*   **특징:** 브라우저(내 컴퓨터)에서 자바스크립트로 동작합니다.
*   **언제 씀?**
    *   버튼을 클릭했을 때 뭔가 반응해야 할 때 (`onClick`)
    *   입력창에 글을 쓸 때 (`onChange`)
    *   스크롤 이벤트를 감지할 때

**💡 꿀팁:**
기본적으로 **서버 컴포넌트**로 페이지를 만들고, 클릭이나 인터랙션이 필요한 **작은 부분(버튼, 캐러셀 등)만 따로 파일로 빼서 `"use client"`를 붙이세요.** (이 프로젝트의 `AddToCartButton.tsx`를 보세요!)

### 🔗 3-2. 동적 라우팅 (`[slug]`)

상품이 1억 개라면 페이지(`page.tsx`)를 1억 개 만들까요? 아니죠.
`src/app/(shop)/products/[category]/[slug]/page.tsx` 처럼 대괄호 `[]`를 씁니다.

*   주소: `site.com/products/clothes/blue-tshirt`
*   `[category]`에는 "clothes"가 들어오고,
*   `[slug]`에는 "blue-tshirt"가 들어옵니다.
*   코드에서는 `params`라는 변수로 이 값들을 받아서 DB에서 해당 상품을 조회합니다.

### ⚡ 3-3. 서버 액션 (Server Actions)

예전에는 "장바구니 담기" 기능을 만들려면:
1.  백엔드 API (`/api/cart`) 만들고
2.  프론트에서 `fetch('/api/cart', ...)` 호출하고
3.  결과 받아서 처리하고... **복잡했습니다.**

Next.js 14+부터는 **서버 액션**을 씁니다.
`src/actions/` 폴더에 있는 함수들은 마치 평범한 자바스크립트 함수처럼 보이지만, 실행하면 **자동으로 서버 API 요청을 날려줍니다.**

```typescript
// src/actions/cart-actions.ts
"use server"; // 이게 핵심!

export async function addToCart(productId) {
  // 이 코드는 오직 서버에서만 실행됩니다. DB 직접 조작 가능!
  await db.cart.create({ data: { productId } });
}
```
프론트엔드 컴포넌트에서는 그냥 `addToCart(1)` 함수 호출하듯이 쓰면 됩니다. 혁명이죠!

### 🚨 3-4. 이름 규칙 (Conventions) - 이거 모르면 에러나요!

Next.js는 **"파일 시스템 라우팅"**을 사용하기 때문에, 파일과 폴더 이름에 아주 강력한 마법이 걸려있습니다. 이걸 모르면 "왜 안 되지?" 하고 밤을 새우게 됩니다. 😱

#### 📁 폴더 이름의 비밀 (특수 기호)

1.  **`(folder)` - 경로 그룹 (Route Group)**
    *   **의미:** "URL 주소에는 넣지 말고, 코드 관리용으로만 묶어줘."
    *   **사용법:** `app/(shop)/page.tsx` → 접속 주소: `site.com/` (shop은 사라짐)
    *   **목적:** 레이아웃(`layout.tsx`)을 다르게 적용하고 싶을 때 씁니다.

2.  **`[folder]` - 동적 라우트 (Dynamic Route)**
    *   **의미:** "여기에 뭐가 들어올지 몰라. 들어오는 값을 변수로 받을게."
    *   **사용법:** `app/products/[id]/page.tsx`
    *   **접속:** `site.com/products/123`, `site.com/products/abc` 모두 가능.
    *   **코드:** `params.id`로 값(123, abc)을 꺼낼 수 있습니다.

3.  **`[...folder]` - 포괄적 라우트 (Catch-all Segments)**
    *   **의미:** "이 뒤에 오는 모든 주소를 다 여기로 보내!"
    *   **사용법:** `app/docs/[...slug]/page.tsx`
    *   **접속:** `site.com/docs/a`, `site.com/docs/a/b`, `site.com/docs/a/b/c/d`
    *   **코드:** `params.slug`는 배열 `['a', 'b', 'c', 'd']`가 됩니다.

4.  **`[[...folder]]` - 선택적 포괄 라우트 (Optional Catch-all)**
    *   **의미:** "뒤에 주소가 있어도 되고, **없어도 돼!**"
    *   **차이점:** 위의 `[...slug]`는 `/docs`만 치면 404 에러가 나지만, `[[...slug]]`는 `/docs`도 접속됩니다.

5.  **`_folder` - 비공개 폴더 (Private Folder)**
    *   **의미:** "이건 라우팅 시스템에서 완전히 무시해줘."
    *   **사용법:** `app/_utils/date.ts`
    *   **목적:** 페이지가 아닌 순수 도우미 함수나 컴포넌트를 `app` 폴더 안에 두고 싶을 때 씁니다.

#### 📄 파일 이름의 비밀 (예약된 파일명)

이 이름들은 Next.js가 미리 찜해둔 것입니다. 오타 내면 안 됩니다!

*   **`page.tsx`**: (필수) 해당 경로의 **실제 화면**입니다. 이게 없으면 404 뜹니다.
*   **`layout.tsx`**: (필수) `page`를 감싸는 **틀**입니다. (`children` prop을 꼭 받아야 함)
*   **`loading.tsx`**: 데이터 로딩 중에 보여줄 **임시 화면** (스켈레톤 UI 등)
*   **`not-found.tsx`**: `notFound()` 함수가 호출되거나 주소가 없을 때 보여줄 **404 화면**
*   **`error.tsx`**: 예기치 못한 에러가 났을 때 보여줄 **에러 화면** (반드시 `"use client"`)
*   **`global-error.tsx`**: 최상위 `layout.tsx` 마저 터졌을 때 보여줄 **치명적 에러 화면**
*   **`route.ts`**: API 엔드포인트 (화면 아님, JSON 응답용)
*   **`template.tsx`**: `layout`과 비슷하지만, 페이지 이동할 때마다 **상태가 초기화**됨 (애니메이션 넣을 때 사용)
*   **`default.tsx`**: 병렬 라우팅(Parallel Routes)에서 기본으로 보여줄 화면

#### ⚙️ 함수 이름의 비밀 (특정 파일 내부)

*   **`generateMetadata`**: SEO 정보를 만들 때 쓰는 함수명 (고정)
*   **`generateStaticParams`**: 동적 페이지(`[id]`)를 미리 빌드해서 정적 페이지로 만들 때 쓰는 함수명 (고정)

### 🎨 3-5. 스타일과 로직 (CSS & TS)

"CSS 파일은 어디에 만드나요?" "자바스크립트 로직은 어디에 두나요?"
이 프로젝트는 **Tailwind CSS**와 **Colocation(관련된 것끼리 모으기)** 원칙을 따릅니다.

1.  **CSS 파일, 안 만듭니다! (Tailwind CSS)**
    *   **원칙:** `styles.css` 파일을 따로 만들어서 왔다 갔다 하지 않습니다.
    *   **방법:** HTML 태그 안에 `className`으로 바로 스타일을 적습니다.
    *   **예시:**
        ```tsx
        // 나쁜 예 (CSS 파일 따로 생성)
        <div className="my-button">버튼</div>

        // 좋은 예 (Tailwind)
        <div className="bg-blue-500 text-white px-4 py-2 rounded">버튼</div>
        ```
    *   **`global.css`:** 모든 페이지에 공통으로 적용되는 기본 설정(폰트 등)만 여기에 둡니다.

2.  **로직 파일, 가까운 곳에 둡니다! (Colocation)**
    *   **원칙:** 페이지에서만 쓰는 컴포넌트나 로직은 그 페이지 폴더 안에 같이 둬도 됩니다.
    *   **공통 로직:** 여러 군데서 쓰면 `src/lib`이나 `src/utils`에 둡니다.
    *   **UI 컴포넌트:** 여러 군데서 쓰면 `src/components`에 둡니다.

### 🖼️ 3-6. 정적 파일 관리 (Images, Audio, Video)

이미지(`png`, `jpg`), 오디오(`mp3`), 비디오(`mp4`) 파일은 어디에 두고 어떻게 쓸까요?

1.  **`public/` 폴더가 창고입니다!**
    *   웹사이트의 모든 정적 자산은 프로젝트 루트의 **`public/`** 폴더에 넣습니다.
    *   이 폴더에 넣은 파일은 주소창에서 바로 접근할 수 있습니다.
    *   예: `public/images/logo.png`에 저장하면, 코드에서는 `/images/logo.png`라고만 적으면 됩니다. (`public`은 생략!)

2.  **이미지는 `next/image`를 쓰세요 (중요!)**
    *   그냥 `<img>` 태그를 쓰면 이미지가 너무 커서 사이트가 느려질 수 있습니다.
    *   Next.js의 `<Image />` 컴포넌트는 이미지를 알아서 압축해주고, 화면에 보일 때만 불러오는(Lazy Loading) 마법을 부립니다.
    *   예시:
        ```tsx
        import Image from 'next/image';

        <Image src="/images/hero.jpg" alt="메인 이미지" width={500} height={300} />
        ```

3.  **오디오/비디오는 어떻게?**
    *   똑같이 `public/`에 넣고 표준 HTML 태그를 쓰면 됩니다.
    *   예시: `<video src="/videos/intro.mp4" controls />`

---

## 🛠️ 4. 사용된 기술들 (Why?)

### 🗄️ Prisma (데이터베이스)
*   **왜 씀?** SQL(`SELECT * FROM...`)을 몰라도 자바스크립트 객체 다루듯이 DB를 쓸 수 있습니다.
*   **예시:** `db.user.findMany()` -> 유저 다 가져와!

### 🎨 Tailwind CSS (스타일링)
*   **왜 씀?** CSS 파일을 왔다 갔다 할 필요 없이, HTML 태그 안에 `class="text-red-500 font-bold"` 처럼 바로 스타일을 줍니다.
*   **장점:** 개발 속도가 엄청나게 빨라집니다. 클래스 이름 짓느라 고민할 필요가 없습니다.

### 🛒 Zustand (장바구니 상태 관리)
*   **왜 씀?** Redux는 너무 어렵고 코드가 깁니다. Context API는 성능 이슈가 있을 수 있습니다.
*   **Zustand:** 아주 쉽고 가볍습니다.
*   **특징:** `persist` 기능을 써서 새로고침해도 장바구니가 유지되도록 설정했습니다(`src/lib/store/cart-store.ts`).

---

## 🌟 5. 실전 코드 뜯어보기

이 가이드를 읽고 나서 코드를 보면 다르게 보일 겁니다.

1.  **`src/app/(shop)/page.tsx` (메인 홈)**
    *   서버 컴포넌트입니다. DB에서 최신 상품들을 가져와서 렌더링합니다.
2.  **`src/components/cart/AddToCartButton.tsx`**
    *   `"use client"`가 붙어있을 겁니다. 왜? 버튼을 '클릭'해야 하니까요.
    *   클릭하면 Zustand store(`useCartStore`)를 사용해 장바구니에 데이터를 넣습니다.
3.  **`src/app/(shop)/products/[category]/[slug]/page.tsx` (상품 상세)**
    *   `generateMetadata`: 페이지 제목과 썸네일을 동적으로 만듭니다 (카톡 공유 시 예쁘게 나오라고).
    *   `product`: URL의 slug를 이용해 DB에서 상품 정보를 가져옵니다.

---

### 마치며

개발은 처음엔 외계어 같지만, **"왜?"**를 이해하면 금방 익숙해집니다.
이 프로젝트가 여러분의 Next.js 여행에 좋은 나침반이 되기를 바랍니다.
